From 92682dfc73b9a0c2e21d5d4311bfd350af496ad8 Mon Sep 17 00:00:00 2001
From: Richard W.M. Jones <rjones@redhat.com>
Date: Thu, 30 Aug 2012 18:19:28 +0100
Subject: [PATCH 27/37] EPEL 5: Revert "Mac OS X: Use libtool --mode=execute instead of LD_LIBRARY_PATH"

This reverts commit 61c9ea496e0579bb7d1bcf496595d66c3f08cfec.
---
 ocaml/Makefile.am |   16 ++++++++--------
 1 files changed, 8 insertions(+), 8 deletions(-)

diff --git a/ocaml/Makefile.am b/ocaml/Makefile.am
index 48ddc2c..b5dbd5f 100644
--- a/ocaml/Makefile.am
+++ b/ocaml/Makefile.am
@@ -114,7 +114,7 @@ noinst_DATA += \
 
 bindtests.bc: bindtests.cmo mlguestfs.cma
 	mkdir -p t
-	$(top_builddir)/libtool -dlopen $(top_builddir)/src/.libs/libguestfs.la --mode=execute \
+	LD_LIBRARY_PATH=../src/.libs \
 	$(OCAMLFIND) ocamlc $(OCAMLCFLAGS) -I . -package unix -linkpkg mlguestfs.cma $< -o $@
 
 bindtests.opt: bindtests.cmx mlguestfs.cmxa
@@ -123,7 +123,7 @@ bindtests.opt: bindtests.cmx mlguestfs.cmxa
 
 t/guestfs_005_load.bc: t/guestfs_005_load.cmo mlguestfs.cma
 	mkdir -p t
-	$(top_builddir)/libtool -dlopen $(top_builddir)/src/.libs/libguestfs.la --mode=execute \
+	LD_LIBRARY_PATH=../src/.libs \
 	$(OCAMLFIND) ocamlc $(OCAMLCFLAGS) -I . -package unix -linkpkg mlguestfs.cma $< -o $@
 
 t/guestfs_005_load.opt: t/guestfs_005_load.cmx mlguestfs.cmxa
@@ -132,7 +132,7 @@ t/guestfs_005_load.opt: t/guestfs_005_load.cmx mlguestfs.cmxa
 
 t/guestfs_010_basic.bc: t/guestfs_010_basic.cmo mlguestfs.cma
 	mkdir -p t
-	$(top_builddir)/libtool -dlopen $(top_builddir)/src/.libs/libguestfs.la --mode=execute \
+	LD_LIBRARY_PATH=../src/.libs \
 	$(OCAMLFIND) ocamlc $(OCAMLCFLAGS) -I . -package unix -linkpkg mlguestfs.cma $< -o $@
 
 t/guestfs_010_basic.opt: t/guestfs_010_basic.cmx mlguestfs.cmxa
@@ -141,7 +141,7 @@ t/guestfs_010_basic.opt: t/guestfs_010_basic.cmx mlguestfs.cmxa
 
 t/guestfs_070_threads.bc: t/guestfs_070_threads.cmo mlguestfs.cma
 	mkdir -p t
-	$(top_builddir)/libtool -dlopen $(top_builddir)/src/.libs/libguestfs.la --mode=execute \
+	LD_LIBRARY_PATH=../src/.libs \
 	$(OCAMLFIND) ocamlc $(OCAMLCFLAGS) -I . -package unix,threads -thread -linkpkg mlguestfs.cma $< -o $@
 
 t/guestfs_070_threads.opt: t/guestfs_070_threads.cmx mlguestfs.cmxa
@@ -150,7 +150,7 @@ t/guestfs_070_threads.opt: t/guestfs_070_threads.cmx mlguestfs.cmxa
 
 t/guestfs_080_optargs.bc: t/guestfs_080_optargs.cmo mlguestfs.cma
 	mkdir -p t
-	$(top_builddir)/libtool -dlopen $(top_builddir)/src/.libs/libguestfs.la --mode=execute \
+	LD_LIBRARY_PATH=../src/.libs \
 	$(OCAMLFIND) ocamlc $(OCAMLCFLAGS) -I . -package unix -linkpkg mlguestfs.cma $< -o $@
 
 t/guestfs_080_optargs.opt: t/guestfs_080_optargs.cmx mlguestfs.cmxa
@@ -159,7 +159,7 @@ t/guestfs_080_optargs.opt: t/guestfs_080_optargs.cmx mlguestfs.cmxa
 
 t/guestfs_400_events.bc: t/guestfs_400_events.cmo mlguestfs.cma
 	mkdir -p t
-	$(top_builddir)/libtool -dlopen $(top_builddir)/src/.libs/libguestfs.la --mode=execute \
+	LD_LIBRARY_PATH=../src/.libs \
 	$(OCAMLFIND) ocamlc $(OCAMLCFLAGS) -I . -package unix -linkpkg mlguestfs.cma $< -o $@
 
 t/guestfs_400_events.opt: t/guestfs_400_events.cmx mlguestfs.cmxa
@@ -168,7 +168,7 @@ t/guestfs_400_events.opt: t/guestfs_400_events.cmx mlguestfs.cmxa
 
 t/guestfs_400_progress.bc: t/guestfs_400_progress.cmo mlguestfs.cma
 	mkdir -p t
-	$(top_builddir)/libtool -dlopen $(top_builddir)/src/.libs/libguestfs.la --mode=execute \
+	LD_LIBRARY_PATH=../src/.libs \
 	$(OCAMLFIND) ocamlc $(OCAMLCFLAGS) -I . -package unix -linkpkg mlguestfs.cma $< -o $@
 
 t/guestfs_400_progress.opt: t/guestfs_400_progress.cmx mlguestfs.cmxa
@@ -177,7 +177,7 @@ t/guestfs_400_progress.opt: t/guestfs_400_progress.cmx mlguestfs.cmxa
 
 t/guestfs_500_mount_local.bc: t/guestfs_500_mount_local.cmo mlguestfs.cma
 	mkdir -p t
-	$(top_builddir)/libtool -dlopen $(top_builddir)/src/.libs/libguestfs.la --mode=execute \
+	LD_LIBRARY_PATH=../src/.libs \
 	$(OCAMLFIND) ocamlc -custom $(OCAMLCFLAGS) -I . -package unix -linkpkg mlguestfs.cma $< -o $@
 
 t/guestfs_500_mount_local.opt: t/guestfs_500_mount_local.cmx mlguestfs.cmxa
-- 
1.7.4.1

