From cffb90f873293433eb9dcc1d30e75effedc1fe5c Mon Sep 17 00:00:00 2001
From: Richard W.M. Jones <rjones@redhat.com>
Date: Sat, 16 Jun 2012 14:35:06 +0100
Subject: [PATCH 06/20] EPEL 5: Remove GObject / GObject Introspection / GJS bindings.

---
 Makefile.am  |    3 --
 configure.ac |   68 ----------------------------------------------------------
 po/POTFILES  |   42 -----------------------------------
 3 files changed, 0 insertions(+), 113 deletions(-)

diff --git a/Makefile.am b/Makefile.am
index 6bd6047..88e3815 100644
--- a/Makefile.am
+++ b/Makefile.am
@@ -84,9 +84,6 @@ endif
 if HAVE_PHP
 SUBDIRS += php
 endif
-if HAVE_GOBJECT
-SUBDIRS += gobject
-endif
 
 # Unconditional because nothing is built yet.
 SUBDIRS += csharp
diff --git a/configure.ac b/configure.ac
index 399a726..4d60102 100644
--- a/configure.ac
+++ b/configure.ac
@@ -1136,67 +1136,6 @@ AS_IF([test "x$PERL" != "xno"],
 AM_CONDITIONAL([HAVE_TOOLS],
     [test "x$PERL" != "xno" && test "x$missing_perl_modules" != "xyes"])
 
-dnl gobject library
-AC_ARG_ENABLE([gobject],
-    AS_HELP_STRING([--disable-gobject], [Disable GObject bindings]),
-    [],
-    [enable_gobject=yes])
-AS_IF(
-  [test "x$enable_gobject" != "xno"],
-  [
-    PKG_CHECK_MODULES([GOBJECT], [gobject-2.0 >= 2.26.0],
-      [
-        AC_SUBST([GOBJECT_CFLAGS])
-        AC_SUBST([GOBJECT_LIBS])
-        AC_DEFINE([HAVE_GOBJECT],[1],
-                  [gobject library found at compile time.])
-      ],
-      [AC_MSG_WARN([gobject library not found, gobject binding will be disabled])]
-    )
-
-    PKG_CHECK_MODULES([GIO], [gio-2.0 >= 2.26.0],
-      [
-        AC_SUBST([GIO_CFLAGS])
-        AC_SUBST([GIO_LIBS])
-        AC_DEFINE([HAVE_GIO],[1],
-                  [gio library found at compile time.])
-      ],
-      [AC_MSG_WARN([gio library not found, gobject binding will be disabled])]
-    )
-  ]
-)
-AM_CONDITIONAL([HAVE_GOBJECT],
-               [test "x$GOBJECT_LIBS" != "x" -a "x$GIO_LIBS" != "x"])
-
-AC_CHECK_PROG([GJS],[gjs],[gjs])
-AS_IF(
-  [test "x$GJS" = "x"],
-  [AC_MSG_WARN([gjs not found, gobject bindtests will not run])]
-)
-
-dnl gobject introspection
-m4_ifdef([GOBJECT_INTROSPECTION_CHECK], [
-    GOBJECT_INTROSPECTION_CHECK([1.30.0])
-
-    dnl The above check automatically sets HAVE_INTROSPECTION, but we
-    dnl want this to be conditional on gobject also being
-    dnl available. We can't move the above check inside the gobject if
-    dnl block above or HAVE_INTROSPECTION ends up undefined, so we
-    dnl recheck it here.
-    AM_CONDITIONAL([HAVE_INTROSPECTION],
-                   [test "x$HAVE_INTROSPECTION_TRUE" = "x" &&
-                    test "x$HAVE_GOBJECT_TRUE" = "x"])
-],[
-    AM_CONDITIONAL([HAVE_INTROSPECTION], [false])
-])
-
-# check for gtk-doc
-m4_ifdef([GTK_DOC_CHECK], [
-GTK_DOC_CHECK([1.14],[--flavour no-tmpl])
-],[
-AM_CONDITIONAL([ENABLE_GTK_DOC], false)
-])
-
 dnl Library versioning.
 MAX_PROC_NR=`cat $srcdir/src/MAX_PROC_NR`
 AC_SUBST(MAX_PROC_NR)
@@ -1230,9 +1169,6 @@ AC_CONFIG_FILES([Makefile
                  generator/Makefile
                  gnulib/lib/Makefile
                  gnulib/tests/Makefile
-                 gobject/Makefile
-                 gobject/docs/Makefile
-                 gobject/docs/guestfs-docs.sgml
                  haskell/Makefile
                  inspector/Makefile
                  java/Makefile
@@ -1310,10 +1246,6 @@ if test "x$HAVE_TOOLS_TRUE" = "x"; then echo "yes"; else echo "no"; fi
 echo -n "OCaml virt tools .................... "
 if test "x$HAVE_OCAML_TRUE" = "x"; then echo "yes"; else echo "no"; fi
 echo "FUSE filesystem ..................... $enable_fuse"
-echo -n "gobject bindings .................... "
-if test "x$HAVE_GOBJECT_TRUE" = "x"; then echo "yes"; else echo "no"; fi
-echo -n "gobject introspection ............... "
-if test "x$HAVE_INTROSPECTION_TRUE" = "x"; then echo "yes"; else echo "no"; fi
 echo -n "GNU gettext for i18n ................ "
 if test "x$HAVE_GNU_GETTEXT_TRUE" = "x"; then echo "yes"; else echo "no"; fi
 echo
diff --git a/po/POTFILES b/po/POTFILES
index 3e3f300..3e87532 100644
--- a/po/POTFILES
+++ b/po/POTFILES
@@ -130,48 +130,6 @@ fish/time.c
 fish/virt.c
 format/format.c
 fuse/guestmount.c
-gobject/src/optargs-add_domain.c
-gobject/src/optargs-add_drive_opts.c
-gobject/src/optargs-btrfs_filesystem_resize.c
-gobject/src/optargs-btrfs_fsck.c
-gobject/src/optargs-compress_device_out.c
-gobject/src/optargs-compress_out.c
-gobject/src/optargs-copy_device_to_device.c
-gobject/src/optargs-copy_device_to_file.c
-gobject/src/optargs-copy_file_to_device.c
-gobject/src/optargs-copy_file_to_file.c
-gobject/src/optargs-e2fsck.c
-gobject/src/optargs-fstrim.c
-gobject/src/optargs-inspect_get_icon.c
-gobject/src/optargs-md_create.c
-gobject/src/optargs-mkfs_btrfs.c
-gobject/src/optargs-mkfs_opts.c
-gobject/src/optargs-mount_9p.c
-gobject/src/optargs-mount_local.c
-gobject/src/optargs-ntfsclone_out.c
-gobject/src/optargs-ntfsfix.c
-gobject/src/optargs-ntfsresize_opts.c
-gobject/src/optargs-set_e2attrs.c
-gobject/src/optargs-test0.c
-gobject/src/optargs-tune2fs.c
-gobject/src/optargs-umount_local.c
-gobject/src/session.c
-gobject/src/struct-application.c
-gobject/src/struct-btrfssubvolume.c
-gobject/src/struct-dirent.c
-gobject/src/struct-inotify_event.c
-gobject/src/struct-int_bool.c
-gobject/src/struct-isoinfo.c
-gobject/src/struct-lvm_lv.c
-gobject/src/struct-lvm_pv.c
-gobject/src/struct-lvm_vg.c
-gobject/src/struct-mdstat.c
-gobject/src/struct-partition.c
-gobject/src/struct-stat.c
-gobject/src/struct-statvfs.c
-gobject/src/struct-version.c
-gobject/src/struct-xattr.c
-gobject/src/tristate.c
 inspector/virt-inspector.c
 java/com_redhat_et_libguestfs_GuestFS.c
 ocaml/guestfs_c.c
-- 
1.7.4.1

