From 94271fa21ac01b583257f2cdff5ba3d9520d206a Mon Sep 17 00:00:00 2001
From: "Richard W.M. Jones" <rjones@redhat.com>
Date: Tue, 5 Nov 2013 07:25:46 +0000
Subject: [PATCH] builder/website: Add index validation test script.

(cherry picked from commit 154bfb7dd46e7998eed1d40ead95923590763739)
---
 builder/website/Makefile.am |  4 ++++
 builder/website/validate.sh | 24 ++++++++++++++++++++++++
 2 files changed, 28 insertions(+)
 create mode 100755 builder/website/validate.sh

diff --git a/builder/website/Makefile.am b/builder/website/Makefile.am
index 4567dd9..b45d98a 100644
--- a/builder/website/Makefile.am
+++ b/builder/website/Makefile.am
@@ -43,3 +43,7 @@ EXTRA_DIST = \
 	ubuntu-13.10.xz.sig
 
 CLEANFILES = *~
+
+# Validates the index file.
+TESTS_ENVIRONMENT = $(top_builddir)/run --test
+TESTS = validate.sh
diff --git a/builder/website/validate.sh b/builder/website/validate.sh
new file mode 100755
index 0000000..f09e30c
--- /dev/null
+++ b/builder/website/validate.sh
@@ -0,0 +1,24 @@
+#!/bin/bash -
+# libguestfs virt-builder validate index
+# Copyright (C) 2013 Red Hat Inc.
+#
+# This program is free software; you can redistribute it and/or modify
+# it under the terms of the GNU General Public License as published by
+# the Free Software Foundation; either version 2 of the License, or
+# (at your option) any later version.
+#
+# This program is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU General Public License for more details.
+#
+# You should have received a copy of the GNU General Public License
+# along with this program; if not, write to the Free Software
+# Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
+
+export LANG=C
+set -e
+
+../virt-index-validate index
+../virt-index-validate index.asc
+
-- 
1.8.3.1

